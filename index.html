<html>

<head>
    <style>
        #screen {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 20px;
        }

        #screenCanvas {
            border: 1px solid white;
            outline: 1px solid lightgray;
        }
    </style>
</head>

<body>
    <div id="screen">
        <canvas id="screenCanvas"></canvas>
    </div>
</body>
<script>
    'use strict'

    function doProcessSeq() {
        var seq1 = "AATCGATGCTAGCTCATCTATCTA-CTAGCTGA"
        var seq2 = "GATCGATGCTAGCACA-CTATCTAGCTAGCTGN"
        var diff = [...seq1].map((x, i) => [i, x, seq2[i]]).filter(x => x[1] != x[2])

        // scale the canvas appropriately
        var totalRows = diff[0].length - 1
        var totalCols = diff.length
        c.setAttribute("width", totalCols * cellWidthPx)
        c.setAttribute("height", totalRows * cellHeightPx)
        var canvasWidth = c.width;
        var canvasHeight = c.height;

        // draw background rectangles
        diff[0].forEach((x, i) => {
            if (i) {
                ctx.fillStyle = i % 2 ? "#69696955" : "white"
                var x0 = 0
                var y0 = (i-1) * canvasHeight
                ctx.fillRect(x0, y0, canvasWidth, cellHeightPx)
                console.log(x0, y0, canvasWidth, cellHeightPx, i % 2 ? "#69696955" : "white")
            }
        })

        // draw boxes
        diff.forEach((rowData, columnIdx) => {
            rowData.forEach((colValue, rowIdx) => {
                if (typeof (colValue) == "string") {
                    // draw rectangle
                    ctx.fillStyle = colour_palette[colValue] ? colour_palette[colValue] : "#69696980"
                    // if we are on the reference row
                    if (rowIdx == 1) {
                        ctx.fillStyle = "#69696980"
                    }
                    var x0 = columnIdx * cellWidthPx
                    var x1 = x0 + cellWidthPx
                    var y0 = (rowIdx - 1) * cellHeightPx
                    var y1 = y0 + cellHeightPx
                    x0 += cellBorderPx
                    x1 -= cellBorderPx
                    y0 += cellBorderPx
                    y1 -= cellBorderPx
                    ctx.fillRect(x0, y0, cellWidthPx - cellBorderPx, cellHeightPx - cellBorderPx)

                    // draw text
                    ctx.fillStyle = "black"
                    ctx.textAlign = "center"
                    ctx.textBaseline = "middle"
                    ctx.font = "20px Arial"
                    ctx.fillText(colValue, (x0 + x1) / 2, (y0 + y1) / 2)
                }
            })
        })

        diff.map(x => x[0]).forEach((x, i) => {
            // draw position text
            ctx.fillStyle = "black"
            ctx.textAlign = "center"
            ctx.textBaseline = "middle"
            ctx.font = "20px Arial"
            var position = x + 1
            ctx.fillText(position, (cellWidthPx * i) + (0.5 * cellWidthPx), c.height / 2)
        })
    }

    // globals
    var c = document.getElementById("screenCanvas");
    var ctx = c.getContext("2d");
    const cellWidthPx = 50
    const cellHeightPx = 50
    const cellBorderPx = 2

    var colour_palette = { "A": "#00800080", "C": "#daa52080", "T": "#4682b480", "G": "#cd5c5c80" }
    var colour_alpha = 0.5

    // init
    function init() {
        doProcessSeq()
    }

    init();
</script>

</html>